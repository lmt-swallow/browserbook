{"componentChunkName":"component---node-modules-rocketseat-gatsby-theme-docs-core-src-templates-docs-query-js","path":"/chapters/building-dom-api","result":{"data":{"mdx":{"id":"c1a01cde-2375-5f2c-badd-a42cbbb2895f","excerpt":"\"JavaScript エンジンを組み込む\"  では、JavaScript エンジンである V8 を利用するようなコードを、Part 1 で作成した Web ブラウザのコードベースに追加しました。\nこの章では Web ページ中の JavaScript が簡単な DOM 操作を行えるように、V8 エンジンと Web…","fields":{"slug":"/chapters/building-dom-api/"},"frontmatter":{"title":"ミニ DOM API を作る","description":"この章では JavaScript から DOM 操作を行えるように、V8 とこれまで作成してきた Web ブラウザの実装をうまく接続します。","image":null,"disableTableOfContents":null},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"ミニ DOM API を作る\",\n  \"description\": \"この章では JavaScript から DOM 操作を行えるように、V8 とこれまで作成してきた Web ブラウザの実装をうまく接続します。\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/chapters/integrating-v8\"\n  }, \"\\\"JavaScript \\u30A8\\u30F3\\u30B8\\u30F3\\u3092\\u7D44\\u307F\\u8FBC\\u3080\\\"\"), \" \\u3067\\u306F\\u3001JavaScript \\u30A8\\u30F3\\u30B8\\u30F3\\u3067\\u3042\\u308B V8 \\u3092\\u5229\\u7528\\u3059\\u308B\\u3088\\u3046\\u306A\\u30B3\\u30FC\\u30C9\\u3092\\u3001Part 1 \\u3067\\u4F5C\\u6210\\u3057\\u305F Web \\u30D6\\u30E9\\u30A6\\u30B6\\u306E\\u30B3\\u30FC\\u30C9\\u30D9\\u30FC\\u30B9\\u306B\\u8FFD\\u52A0\\u3057\\u307E\\u3057\\u305F\\u3002\\n\\u3053\\u306E\\u7AE0\\u3067\\u306F Web \\u30DA\\u30FC\\u30B8\\u4E2D\\u306E JavaScript \\u304C\\u7C21\\u5358\\u306A DOM \\u64CD\\u4F5C\\u3092\\u884C\\u3048\\u308B\\u3088\\u3046\\u306B\\u3001V8 \\u30A8\\u30F3\\u30B8\\u30F3\\u3068 Web \\u30D6\\u30E9\\u30A6\\u30B6\\u5B9F\\u88C5\\u3092\\u63A5\\u7D9A\\u3057\\u307E\\u3059\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\uD83D\\uDCDD \\u6CE8\\u610F\"), \" \\u672C\\u30AA\\u30F3\\u30E9\\u30A4\\u30F3\\u30D6\\u30C3\\u30AF\\u306F\\u30BB\\u30AD\\u30E5\\u30EA\\u30C6\\u30A3\\u30FB\\u30AD\\u30E3\\u30F3\\u30D7\\u3067\\u306E\\u8B1B\\u7FA9\\u306E\\u4E8B\\u524D\\u8CC7\\u6599\\u3067\\u3042\\u308A\\u3001\\u304B\\u3064\\u3053\\u306E\\u5468\\u8FBA\\u306F\\u8B1B\\u7FA9\\u3067\\u8A73\\u7D30\\u306B\\u6271\\u3046\\u4E88\\u5B9A\\u304C\\u3042\\u307E\\u308A\\u3042\\u308A\\u307E\\u305B\\u3093\\u3002\\n\\u3057\\u305F\\u304C\\u3063\\u3066\\u672C\\u7AE0\\u306F\\u3001\\u4E00\\u65E6\\u30EA\\u30D5\\u30A1\\u30EC\\u30F3\\u30B9\\u5B9F\\u88C5\\uFF08\\u5F8C\\u8FF0\\uFF09\\u3092\\u8AAD\\u3080\\u969B\\u306E\\u8CC7\\u6599\\u3068\\u3057\\u3066\\u4F7F\\u3048\\u308B\\u7A0B\\u5EA6\\u306E\\u5927\\u96D1\\u628A\\u3055\\u3067\\u66F8\\u3044\\u3066\\u3042\\u308A\\u307E\\u3059\\u3002\\n\\u7B46\\u8005\\u306E\\u4F59\\u88D5\\u304C\\u3067\\u304D\\u305F\\u9803\\u306B\\u5927\\u5E45\\u306B\\u66F8\\u304D\\u76F4\\u3059\\u4E88\\u5B9A\\u3067\\u3059\\u3002\")), mdx(\"h2\", {\n    \"id\": \"本章での実装方針\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#%E6%9C%AC%E7%AB%A0%E3%81%A7%E3%81%AE%E5%AE%9F%E8%A3%85%E6%96%B9%E9%87%9D\",\n    \"aria-label\": \"本章での実装方針 permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"\\u672C\\u7AE0\\u3067\\u306E\\u5B9F\\u88C5\\u65B9\\u91DD\"), mdx(\"p\", null, \"JavaScript \\u304B\\u3089 DOM \\u3092\\u64CD\\u4F5C\\u3059\\u308B\\u969B\\u306B\\u306F\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Element\"), \" \\u306E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"innerHTML\"), \" \\u30D7\\u30ED\\u30D1\\u30C6\\u30A3\\uFF08\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://w3c.github.io/DOM-Parsing/#dom-innerhtml\"\n  }, \"\\u203B DOM Parsing and Serialization \\u306B\\u304A\\u3051\\u308B\\u5B9A\\u7FA9\"), \"\\uFF09 \\u3084 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Document\"), \" \\u306E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getElementById\"), \" \\u95A2\\u6570\\uFF08\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://dom.spec.whatwg.org/#dom-nonelementparentnode-getelementbyid\"\n  }, \"\\u203B DOM Standard \\u306B\\u304A\\u3051\\u308B\\u5B9A\\u7FA9\"), \"\\uFF09\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"appendChild\"), \" \\u95A2\\u6570\\uFF08\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://dom.spec.whatwg.org/#dom-node-appendchild\"\n  }, \"\\u203B DOM Standard \\u306B\\u304A\\u3051\\u308B\\u5B9A\\u7FA9\"), \"\\uFF09\\u3068\\u3044\\u3063\\u305F\\u3082\\u306E\\u3092\\u53D6\\u308A\\u6271\\u3063\\u305F\\u3053\\u3068\\u304C\\u3042\\u308B\\u3053\\u3068\\u3067\\u3057\\u3087\\u3046\\u3002\"), mdx(\"p\", null, \"\\u3053\\u3046\\u3044\\u3063\\u305F\\u6A5F\\u80FD\\u3092 \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/tiny-browserbook/exercise-js\"\n  }, \"\\\"JavaScript \\u30A8\\u30F3\\u30B8\\u30F3\\u3092\\u7D44\\u307F\\u8FBC\\u3080\\\" \\u3067\\u53D6\\u308A\\u6271\\u3063\\u305F\\u6F14\\u7FD2\\u7528\\u5B9F\\u88C5\"), \" \\u3092\\u62E1\\u5F35\\u3057\\u3066\\u5B9F\\u88C5\\u3059\\u308B\\u305F\\u3081\\u306B\\u306F\\u3001\\u8FFD\\u52A0\\u3067\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306A\\u5B9F\\u88C5\\u3092\\u3057\\u3066\\u3084\\u308B\\u5FC5\\u8981\\u304C\\u3042\\u308A\\u307E\\u3059:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"src/main.rs\"), \" \\u3067\\u751F\\u6210\\u3057\\u305F DOM \\u306E\\u60C5\\u5831\\u306E\\u63CF\\u753B\\u4E2D\\u306E\\u4FDD\\u6301\\u3092\\u3046\\u307E\\u304F\\u3084\\u308B\\uFF08\\u5F8C\\u8FF0\\uFF09\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"DOM \\u64CD\\u4F5C\\u95A2\\u9023\\u306E Rust \\u5B9F\\u88C5\\u3092\\u7528\\u610F\\u3059\\u308B\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"DOM \\u64CD\\u4F5C\\u95A2\\u9023\\u306E V8 \\u30D0\\u30A4\\u30F3\\u30C7\\u30A3\\u30F3\\u30B0\\u3092\\u5B9F\\u88C5\\u3059\\u308B\")), mdx(\"p\", null, \"\\u672C\\u7AE0\\u3067\\u306F\\u3001\\u3053\\u308C\\u3089\\u306E\\u5B9F\\u88C5\\u306B\\u3001\\u5B9F\\u969B\\u306B \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/tiny-browserbook/exercise-js\"\n  }, \"\\\"JavaScript \\u30A8\\u30F3\\u30B8\\u30F3\\u3092\\u7D44\\u307F\\u8FBC\\u3080\\\" \\u3067\\u53D6\\u308A\\u6271\\u3063\\u305F\\u6F14\\u7FD2\\u7528\\u5B9F\\u88C5\"), \" \\u3092\\u62E1\\u5F35\\u3057\\u3066\\u3044\\u304F\\u5F62\\u3067\\u53D6\\u308A\\u7D44\\u3093\\u3067\\u3044\\u304D\\u307E\\u3059\\u3002\\n\\u306A\\u304A\\u3001JavaScript \\u304B\\u3089\\u5229\\u7528\\u3067\\u304D\\u308B DOM \\u64CD\\u4F5C\\u306F\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Element\"), \" \\u30A4\\u30F3\\u30BF\\u30FC\\u30D5\\u30A7\\u30A4\\u30B9\\u306E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"innerHTML\"), \" \\u30D7\\u30ED\\u30D1\\u30C6\\u30A3\\u3068 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tagName\"), \" \\u30D7\\u30ED\\u30D1\\u30C6\\u30A3\\u3001\\u305D\\u3057\\u3066 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Document\"), \" \\u30A4\\u30F3\\u30BF\\u30FC\\u30D5\\u30A7\\u30A4\\u30B9\\u306E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getElementById\"), \" \\u95A2\\u6570\\u306E\\u307F\\u306B\\u5236\\u9650\\u3059\\u308B\\u3053\\u3068\\u306B\\u3057\\u307E\\u3059\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u672C\\u7AE0\\u306E\\u30EA\\u30D5\\u30A1\\u30EC\\u30F3\\u30B9\\u5B9F\\u88C5\\uFF08\\u4E00\\u901A\\u308A\\u5B9F\\u88C5\\u3092\\u7D42\\u3048\\u305F\\u5F8C\\u306E\\u5B9F\\u88C5\\uFF09\\u306F\\u4EE5\\u4E0B\\u306E\\u30B3\\u30DE\\u30F3\\u30C9\\u3067\\u30C0\\u30A6\\u30F3\\u30ED\\u30FC\\u30C9\\u3067\\u304D\\u307E\\u3059\\u3002\\n\\u4EE5\\u964D\\u306E\\u8AAC\\u660E\\u306F\\u3001\\u5FC5\\u8981\\u306B\\u5FDC\\u3058\\u3066 \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/tiny-browserbook/exercise-js\"\n  }, \"\\\"JavaScript \\u30A8\\u30F3\\u30B8\\u30F3\\u3092\\u7D44\\u307F\\u8FBC\\u3080\\\" \\u3067\\u53D6\\u308A\\u6271\\u3063\\u305F\\u6F14\\u7FD2\\u7528\\u5B9F\\u88C5\"), \" \\u3068\\u3001\\u4EE5\\u4E0B\\u306E\\u5B9F\\u88C5\\u3092\\u6BD4\\u8F03\\u3057\\u306A\\u304C\\u3089\\u8AAD\\u307F\\u9032\\u3081\\u3066\\u304F\\u3060\\u3055\\u3044\\u3002\"), mdx(\"pre\", {\n    parentName: \"blockquote\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-sh\"\n  }, \"git clone https://github.com/tiny-browserbook/exercise-domapi\\n\"))), mdx(\"h2\", {\n    \"id\": \"実装\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#%E5%AE%9F%E8%A3%85\",\n    \"aria-label\": \"実装 permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"\\u5B9F\\u88C5\"), mdx(\"p\", null, \"\\u4E00\\u3064\\u305A\\u3064\\u5012\\u3057\\u3066\\u3044\\u304D\\u307E\\u3057\\u3087\\u3046\\u3002\"), mdx(\"h3\", {\n    \"id\": \"web-ブラウザの状態保持の実装\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#web-%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%AE%E7%8A%B6%E6%85%8B%E4%BF%9D%E6%8C%81%E3%81%AE%E5%AE%9F%E8%A3%85\",\n    \"aria-label\": \"web ブラウザの状態保持の実装 permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Web \\u30D6\\u30E9\\u30A6\\u30B6\\u306E\\u72B6\\u614B\\u4FDD\\u6301\\u306E\\u5B9F\\u88C5\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/tiny-browserbook/exercise-js\"\n  }, \"\\\"JavaScript \\u30A8\\u30F3\\u30B8\\u30F3\\u3092\\u7D44\\u307F\\u8FBC\\u3080\\\" \\u3067\\u53D6\\u308A\\u6271\\u3063\\u305F\\u6F14\\u7FD2\\u7528\\u5B9F\\u88C5\"), \" \\u306E \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/tiny-browserbook/exercise-js/blob/answer/src/main.rs#L50-L68\"\n  }, \"src/main.rs\"), \" \\u3067\\u306F\\u3001\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306A\\u5F62\\u3067 HTML \\u3092\\u30D1\\u30FC\\u30B9\\u30FB\\u63CF\\u753B\\u3057\\u3066\\u3044\\u307E\\u3057\\u305F:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"fn main() {\\n    let mut siv = cursive::default();\\n\\n    let node = html::parse(HTML);\\n    let stylesheet = css::parse(&format!(\\n        \\\"{}\\\\n{}\\\",\\n        DEFAULT_STYLESHEET,\\n        collect_tag_inners(&node, \\\"style\\\".into()).join(\\\"\\\\n\\\")\\n    ));\\n\\n    let container = to_styled_node(&node, &stylesheet)\\n        .and_then(|styled_node| Some(to_layout_box(styled_node)))\\n        .and_then(|layout_box| Some(to_element_container(layout_box)));\\n    if let Some(c) = container {\\n        siv.add_fullscreen_layer(c);\\n    }\\n\\n    siv.run();\\n}\\n\")), mdx(\"p\", null, \"\\u3057\\u304B\\u3057\\u3001\\u3053\\u306E\\u3088\\u3046\\u306A\\u51E6\\u7406\\u306E\\u6D41\\u308C\\u3067\\u306F\\u3001\\u753B\\u9762\\u63CF\\u753B\\u304C\\u59CB\\u307E\\u3063\\u305F\\u5F8C\\uFF08\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"siv.run()\"), \" \\u306E\\u5B9F\\u884C\\u5F8C\\uFF09\\u306F \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"main()\"), \" \\u95A2\\u6570\\u306E\\u307F\\u304C DOM \\u30C4\\u30EA\\u30FC\\u3078\\u306E\\u53C2\\u7167\\u3092\\u6709\\u3057\\u3066\\u304A\\u308A\\u3001\\u753B\\u9762\\u306B\\u63CF\\u753B\\u3055\\u308C\\u3066\\u3044\\u308B Cursive \\u30D3\\u30E5\\u30FC\\u3084\\u3001JavaScript \\u51E6\\u7406\\u7CFB\\u306F DOM \\u30C4\\u30EA\\u30FC\\u3078\\u306E\\u53C2\\u7167\\u3092\\u6301\\u3061\\u307E\\u305B\\u3093\\u3002\\n\\u3053\\u308C\\u3067\\u306F\\u753B\\u9762\\u306B\\u63CF\\u753B\\u3055\\u308C\\u3066\\u3044\\u308B Cursive \\u30D3\\u30E5\\u30FC\\u304C\\u8868\\u793A\\u5185\\u5BB9\\u306E\\u5909\\u66F4\\u3068 DOM \\u30C4\\u30EA\\u30FC\\u306E\\u72B6\\u614B\\u3092\\u540C\\u671F\\u3057\\u305F\\u308A\\u3001JavaScript \\u5074\\u304B\\u3089 DOM \\u30C4\\u30EA\\u30FC\\u3092\\u64CD\\u4F5C\\u3059\\u308B\\u306E\\u304C\\u96E3\\u3057\\u3044\\u306F\\u305A\\u3067\\u3059\\u3002\"), mdx(\"p\", null, \"\\u305D\\u3053\\u3067\\u3001Web \\u30D6\\u30E9\\u30A6\\u30B6\\u304C\\u63CF\\u753B\\u3057\\u3066\\u3044\\u308B Web \\u30DA\\u30FC\\u30B8\\u306B\\u95A2\\u3059\\u308B\\u72B6\\u614B\\u3092 JavaScript \\u304B\\u3089\\u89E6\\u308C\\u308B\\u3088\\u3046\\u306B\\u3059\\u308B\\u305F\\u3081\\u306B\\u3001\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306A\\u4FEE\\u6B63\\u3092\\u884C\\u3046\\u3053\\u3068\\u306B\\u3057\\u307E\\u3059:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u753B\\u9762\\u63CF\\u753B\\u306B\\u7528\\u3044\\u3089\\u308C\\u308B Cursive \\u306E\\u30D3\\u30E5\\u30FC\\u3067 DOM \\u30C4\\u30EA\\u30FC\\u3092\\u4FDD\\u6301\\u3059\\u308B\\u3088\\u3046\\u306B\\u3059\\u308B\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/tiny-browserbook/exercise-js/blob/answer/src/javascript.rs#L12-L14\"\n  }, \"JavaScriptRuntime\"), \" \\u306E\\u4ED8\\u968F\\u3059\\u308B\\u72B6\\u614B \", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://github.com/tiny-browserbook/exercise-js/blob/answer/src/javascript.rs#L5-L7\"\n  }, \"JavaScriptRuntimeState\"), \" \\u304C\\u3001JavaScript \\u30B3\\u30FC\\u30C9\\u306E\\u5B9F\\u884C\\u306B\\u4ED8\\u968F\\u3057\\u3066\\u5229\\u7528\\u3067\\u304D\\u308B DOM \\u30C4\\u30EA\\u30FC\\u3078\\u306E\\u53C2\\u7167\\u3084\\u3001Web \\u30D6\\u30E9\\u30A6\\u30B6\\u6A5F\\u80FD\\u306E API \\uFF08\\u4EE5\\u964D \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"RendererAPI\"), \" \\u3068\\u547C\\u3076\\uFF09\\u3078\\u306E\\u53C2\\u7167\\u3092\\u6301\\u3064\\u3088\\u3046\\u306B\\u30B3\\u30FC\\u30C9\\u3092\\u4FEE\\u6B63\\u3059\\u308B\")), mdx(\"p\", null, \"\\u307E\\u305A\\u306F \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/renderer.rs\"), \" \\u30D5\\u30A1\\u30A4\\u30EB\\u3092\\u4F5C\\u6210\\u3057\\u3066\\u3001DOM \\u30C4\\u30EA\\u30FC\\u3068 JavaScript \\u51E6\\u7406\\u7CFB\\u306E\\u30A4\\u30F3\\u30B9\\u30BF\\u30F3\\u30B9\\u3092\\u307E\\u3068\\u3081\\u3066\\u4FDD\\u6301\\u3059\\u308B Cursive \\u306E\\u30D3\\u30E5\\u30FC \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Renderer\"), \" \\u3092\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306B\\u5B9A\\u7FA9\\u3057\\u307E\\u3057\\u3087\\u3046\", mdx(\"sup\", {\n    parentName: \"p\",\n    \"id\": \"fnref-1\"\n  }, mdx(\"a\", {\n    parentName: \"sup\",\n    \"href\": \"#fn-1\",\n    \"className\": \"footnote-ref\"\n  }, \"1\")), \":\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"use crate::{\\n    css,\\n    dom::{Node, NodeType},\\n    javascript::{renderapi::RendererAPI, JavaScriptRuntime},\\n    layout::to_layout_box,\\n    render::{to_element_container, ElementContainer},\\n    style::to_styled_node,\\n};\\nuse cursive::{\\n    direction::Direction,\\n    event::{AnyCb, Event, EventResult},\\n    view::{Selector, View, ViewNotFound},\\n    Rect, Vec2,\\n};\\n\\nuse cursive::CbSink;\\nuse std::{cell::RefCell, rc::Rc};\\n\\npub struct Renderer {\\n    view: ElementContainer, // \\u73FE\\u5728\\u753B\\u9762\\u306B\\u63CF\\u753B\\u3057\\u3066\\u3044\\u308B\\u5B9F\\u969B\\u306E Cursive \\u30D3\\u30E5\\u30FC\\n    document_element: Rc<RefCell<Box<Node>>>, // view \\u306E\\u5143\\u3068\\u306A\\u3063\\u3066\\u3044\\u308B DOM \\u30C4\\u30EA\\u30FC\\n    js_runtime_instance: JavaScriptRuntime, // Cursive \\u30D3\\u30E5\\u30FC\\u306B\\u95A2\\u9023\\u3057\\u305F JavaScript \\u51E6\\u7406\\u7CFB\\u306E\\u30A4\\u30F3\\u30B9\\u30BF\\u30F3\\u30B9\\n}\\n\\n// Renderer \\u3092 Cursive \\u306E\\u30D3\\u30E5\\u30FC\\u3068\\u3057\\u3066\\u5229\\u7528\\u3059\\u308B\\u305F\\u3081\\u306E\\u5B9F\\u88C5\\nimpl View for Renderer {\\n    fn draw(&self, printer: &cursive::Printer) {\\n        self.view.draw(printer)\\n    }\\n\\n    fn layout(&mut self, v: Vec2) {\\n        self.view.layout(v)\\n    }\\n\\n    fn needs_relayout(&self) -> bool {\\n        self.view.needs_relayout()\\n    }\\n\\n    fn required_size(&mut self, constraint: Vec2) -> Vec2 {\\n        self.view.required_size(constraint)\\n    }\\n\\n    fn on_event(&mut self, e: Event) -> EventResult {\\n        self.view.on_event(e)\\n    }\\n\\n    fn call_on_any<'a>(&mut self, s: &Selector<'_>, cb: AnyCb<'a>) {\\n        self.view.call_on_any(s, cb)\\n    }\\n\\n    fn focus_view(&mut self, s: &Selector<'_>) -> Result<(), ViewNotFound> {\\n        self.view.focus_view(s)\\n    }\\n\\n    fn take_focus(&mut self, source: Direction) -> bool {\\n        self.view.take_focus(source)\\n    }\\n\\n    fn important_area(&self, view_size: Vec2) -> Rect {\\n        self.view.important_area(view_size)\\n    }\\n\\n    fn type_name(&self) -> &'static str {\\n        self.view.type_name()\\n    }\\n}\\n\")), mdx(\"p\", null, \"\\u305D\\u3057\\u3066\\u3001\\u753B\\u9762\\u63CF\\u753B\\u304C\\u59CB\\u307E\\u3063\\u305F\\u5F8C\\u306E DOM \\u30C4\\u30EA\\u30FC\\u306E\\u4FDD\\u6301\\u30FB\\u66F4\\u65B0\\u306E\\u305F\\u3081\\u306E\\u6A5F\\u80FD\\u306F\\u3053\\u306E\\u69CB\\u9020\\u4F53\\u306B\\u6301\\u305F\\u305B\\u3066\\u3084\\u308B\\u3053\\u3068\\u3057\\u307E\\u3057\\u3087\\u3046\\u3002\\n\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306B\\u3067\\u3059:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"const DEFAULT_STYLESHEET: &str = r#\\\"\\nscript, style {\\n    display: none;\\n}\\np, div {\\n    display: block;\\n}\\n\\\"#;\\n\\nfn collect_tag_inners(node: &Box<Node>, tag_name: &str) -> Vec<String> {\\n    if let NodeType::Element(ref element) = node.node_type {\\n        if element.tag_name.as_str() == tag_name {\\n            return vec![node.inner_text()];\\n        }\\n    }\\n\\n    node.children\\n        .iter()\\n        .map(|child| collect_tag_inners(child, tag_name))\\n        .collect::<Vec<Vec<String>>>()\\n        .into_iter()\\n        .flatten()\\n        .collect()\\n}\\n\\nimpl Renderer {\\n    // \\u65B0\\u3057\\u3044 Renderer \\u3092\\u751F\\u6210\\u3059\\u308B\\u95A2\\u6570\\n    pub fn new(ui_cb_sink: Rc<CbSink>, document_element: Box<Node>) -> Self {\\n        let stylesheet = css::parse(&format!(\\n            \\\"{}\\\\n{}\\\",\\n            DEFAULT_STYLESHEET,\\n            collect_tag_inners(&document_element, \\\"style\\\".into()).join(\\\"\\\\n\\\")\\n        ));\\n\\n        let view = to_styled_node(&document_element, &stylesheet)\\n            .and_then(|styled_node| Some(to_layout_box(styled_node)))\\n            .and_then(|layout_box| Some(to_element_container(layout_box)))\\n            .unwrap();\\n\\n        let document_element = Rc::new(RefCell::new(document_element));\\n        let document_element_ref = document_element.clone();\\n        Self {\\n            document_element,\\n            view,\\n            js_runtime_instance: JavaScriptRuntime::new(\\n                document_element_ref,\\n                Rc::new(RendererAPI::new(ui_cb_sink)),\\n            ),\\n        }\\n    }\\n\\n    // Renderer \\u304C\\u7BA1\\u7406\\u3059\\u308B DOM \\u30C4\\u30EA\\u30FC\\uFF08self.document_element\\uFF09\\u3092\\u3082\\u3068\\u306B\\u3001\\n    // \\u753B\\u9762\\u306B\\u63CF\\u753B\\u3055\\u308C\\u308B Cursive \\u30D3\\u30E5\\u30FC\\uFF08self.view\\uFF09\\u3092\\u518D\\u751F\\u6210\\u3059\\u308B\\u95A2\\u6570\\n    pub fn rerender(&mut self) {\\n        let document_element = self.document_element.borrow();\\n        let stylesheet = css::parse(&format!(\\n            \\\"{}\\\\n{}\\\",\\n            DEFAULT_STYLESHEET,\\n            collect_tag_inners(&document_element, \\\"style\\\".into()).join(\\\"\\\\n\\\")\\n        ));\\n        self.view = to_styled_node(&document_element, &stylesheet)\\n            .and_then(|styled_node| Some(to_layout_box(styled_node)))\\n            .and_then(|layout_box| Some(to_element_container(layout_box)))\\n            .unwrap();\\n    }\\n\\n    // Renderer \\u304C\\u7BA1\\u7406\\u3059\\u308B DOM \\u30C4\\u30EA\\u30FC\\uFF08self.document_element\\uFF09\\u5185\\u306E JavaScript \\u3092\\u5B9F\\u884C\\u3059\\u308B\\u95A2\\u6570\\n    pub fn execute_inline_scripts(&mut self) {\\n        let scripts = {\\n            let document_element = self.document_element.borrow();\\n            collect_tag_inners(&document_element, \\\"script\\\".into()).join(\\\"\\\\n\\\")\\n        };\\n        self.js_runtime_instance\\n            .execute(\\\"(inline)\\\", scripts.as_str())\\n            .unwrap();\\n    }\\n}\\n\")), mdx(\"p\", null, \"\\u7D9A\\u3044\\u3066\\u3001DOM \\u30C4\\u30EA\\u30FC\\u3078\\u306E\\u53C2\\u7167\\u3068 JavaScript \\u30B3\\u30FC\\u30C9\\u306E\\u5B9F\\u884C\\u306B\\u4ED8\\u968F\\u3057\\u3066\\u5229\\u7528\\u3067\\u304D\\u308B Web \\u30D6\\u30E9\\u30A6\\u30B6\\u6A5F\\u80FD\\u306E API \\uFF08\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"RendererAPI\"), \"\\uFF09\\u3078\\u306E\\u53C2\\u7167\\u3092 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JavaScriptRuntimeState\"), \" \\u304C\\u6301\\u3064\\u3088\\u3046\\u306B\\u30B3\\u30FC\\u30C9\\u3092\\u4FEE\\u6B63\\u3057\\u307E\\u3057\\u3087\\u3046\\u3002\\u5177\\u4F53\\u7684\\u306B\\u5B9F\\u88C5\\u4F8B\\u3092\\u793A\\u3057\\u307E\\u3059:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"pub struct JavaScriptRuntimeState {\\n    pub context: v8::Global<v8::Context>,\\n    pub renderer_api: Rc<RendererAPI>, // Web \\u30D6\\u30E9\\u30A6\\u30B6\\u6A5F\\u80FD\\u306E API \\u3078\\u306E\\u53C2\\u7167\\n    pub document_element: Rc<RefCell<Box<Node>>>, // DOM \\u30C4\\u30EA\\u30FC\\u3078\\u306E\\u53C2\\u7167\\n}\\n\")), mdx(\"p\", null, \"\\u305D\\u3057\\u3066\\u3001JavaScript \\u30B3\\u30FC\\u30C9\\u306E\\u51E6\\u7406\\u306B\\u4ED8\\u968F\\u3057\\u3066\\u5229\\u7528\\u3067\\u304D\\u308B Web \\u30D6\\u30E9\\u30A6\\u30B6\\u6A5F\\u80FD\\u306E API \\u3067\\u3042\\u308B \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"RendererAPI\"), \" \\u3068\\u3057\\u3066\\u3001\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306A\\u5B9F\\u88C5\\u3092 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/javascript/renderapi.rs\"), \" \\u5185\\u306B\\u7528\\u610F\\u3059\\u308B\\u3053\\u3068\\u306B\\u3057\\u307E\\u3059:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"use cursive::{views::LayerPosition, CbSink};\\nuse std::rc::Rc;\\n\\nuse crate::browser::Renderer;\\n\\n/// JavaScript \\u30B3\\u30FC\\u30C9\\u306E\\u51E6\\u7406\\u306B\\u4ED8\\u968F\\u3057\\u3066\\u5229\\u7528\\u3067\\u304D\\u308B Web \\u30D6\\u30E9\\u30A6\\u30B6\\u6A5F\\u80FD\\u306E API\\npub struct RendererAPI {\\n    ui_cb_sink: Rc<CbSink>,\\n}\\n\\nimpl RendererAPI {\\n    pub fn new(ui_cb_sink: Rc<CbSink>) -> Self {\\n        Self { ui_cb_sink }\\n    }\\n\\n    // \\u6700\\u65B0\\u306E DOM \\u30C4\\u30EA\\u30FC\\u3092\\u7528\\u3044\\u305F\\u753B\\u9762\\u306E\\u518D\\u63CF\\u753B\\u3092 Cursive \\u30D3\\u30E5\\u30FC\\u306B\\u8981\\u6C42\\u3059\\u308B\\u95A2\\u6570\\n    pub fn rerender(&self) {\\n        self.ui_cb_sink\\n            .send(Box::new(move |s: &mut cursive::Cursive| {\\n                let screen = s.screen_mut();\\n                let layer: &mut Renderer = screen\\n                    .get_mut(LayerPosition::FromFront(0))\\n                    .unwrap()\\n                    .downcast_mut()\\n                    .unwrap();\\n                layer.rerender()\\n            }))\\n            .unwrap();\\n    }\\n}\\n\")), mdx(\"p\", null, \"\\u6700\\u5F8C\\u306B\\u3001\\u3053\\u308C\\u3089\\u306E\\u4FEE\\u6B63\\u306B\\u5408\\u308F\\u305B\\u3066\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main.rs\"), \" \\u3092\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306B\\u5909\\u66F4\\u3057\\u307E\\u3057\\u3087\\u3046:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"use exercise_domapi::{html, renderer::Renderer};\\nuse std::rc::Rc;\\n\\nconst HTML: &str = r#\\\"...\\\"#;\\n\\nfn main() {\\n    let mut siv = cursive::default();\\n\\n    // HTML \\u3092\\u30D1\\u30FC\\u30B9\\u3059\\u308B\\n    let node = html::parse(HTML);\\n\\n    // Renderer \\u3092\\u751F\\u6210\\u3059\\u308B\\n    let mut renderer = Renderer::new(Rc::new(siv.cb_sink().clone()), node);\\n\\n    // Renderer \\u304C\\u6709\\u3059\\u308B Web \\u30DA\\u30FC\\u30B8\\u306E JavaScript \\u3092\\u5B9F\\u884C\\u3059\\u308B\\n    renderer.execute_inline_scripts();\\n\\n    // Renderer \\u306B\\u3088\\u308B TUI \\u306E\\u63CF\\u753B\\u3092\\u958B\\u59CB\\u3059\\u308B\\n    siv.add_fullscreen_layer(renderer);\\n    siv.run();\\n}\\n\")), mdx(\"p\", null, \"\\u3053\\u308C\\u3067\\u6700\\u521D\\u306E\\u30B9\\u30C6\\u30C3\\u30D7\\u306F\\u30AF\\u30EA\\u30A2\\u3067\\u3059\\u3002\"), mdx(\"h3\", {\n    \"id\": \"dom-操作関連の-rust-実装の用意\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#dom-%E6%93%8D%E4%BD%9C%E9%96%A2%E9%80%A3%E3%81%AE-rust-%E5%AE%9F%E8%A3%85%E3%81%AE%E7%94%A8%E6%84%8F\",\n    \"aria-label\": \"dom 操作関連の rust 実装の用意 permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"DOM \\u64CD\\u4F5C\\u95A2\\u9023\\u306E Rust \\u5B9F\\u88C5\\u306E\\u7528\\u610F\"), mdx(\"p\", null, \"\\u3044\\u307E\\u306F JavaScript \\u304B\\u3089\\u884C\\u3048\\u308B DOM \\u64CD\\u4F5C\\u3092 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"document.getElementById()\"), \" \\u3084 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Element\"), \" \\u306B\\u5BFE\\u3059\\u308B \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"innerHTML\"), \" / \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"tagName\"), \" \\u306E\\u64CD\\u4F5C\\u306B\\u5236\\u9650\\u3057\\u3066\\u3044\\u307E\\u3057\\u305F\\u3002\\u3053\\u308C\\u3089\\u306E\\u64CD\\u4F5C\\u306E\\u5B9F\\u88C5\\u306B\\u3080\\u3051\\u3066\\u3001\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306B \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Node\"), \" \\u69CB\\u9020\\u4F53\\u306E\\u5B9F\\u88C5\\u3092\\u62E1\\u5F35\\u3057\\u307E\\u3057\\u3087\\u3046\", mdx(\"sup\", {\n    parentName: \"p\",\n    \"id\": \"fnref-2\"\n  }, mdx(\"a\", {\n    parentName: \"sup\",\n    \"href\": \"#fn-2\",\n    \"className\": \"footnote-ref\"\n  }, \"2\")), \":\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"impl Node {\\n    pub fn inner_text(&self) -> String {\\n        self.children\\n            .iter()\\n            .map(|node| match &node.node_type {\\n                NodeType::Text(t) => t.data.clone(),\\n                _ => node.inner_text(),\\n            })\\n            .collect::<Vec<_>>()\\n            .join(\\\"\\\")\\n    }\\n\\n    pub fn inner_html(&self) -> String {\\n        self.children\\n            .iter()\\n            .map(|node| node.to_string())\\n            .collect::<Vec<_>>()\\n            .join(\\\"\\\")\\n    }\\n\\n    pub fn set_inner_html(&mut self, html: &str) {\\n        self.children = html::parse_raw(html.into());\\n    }\\n\\n    pub fn get_element_by_id<'a>(self: &'a mut Box<Self>, id: &str) -> Option<&'a mut Box<Self>> {\\n        match self.node_type {\\n            NodeType::Element(ref e) => {\\n                if e.id().map(|eid| eid.to_string() == id).unwrap_or(false) {\\n                    return Some(self);\\n                }\\n            }\\n            _ => (),\\n        };\\n        self.children\\n            .iter_mut()\\n            .find_map(|child| child.get_element_by_id(id))\\n    }\\n}\\n\\nimpl ToString for Node {\\n    fn to_string(&self) -> String {\\n        match self.node_type {\\n            NodeType::Element(ref e) => {\\n                let attrs = e\\n                    .attributes\\n                    .iter()\\n                    .clone()\\n                    .into_iter()\\n                    .map(|(k, v)| {\\n                        // TODO (security): do this securely! This might causes mXSS.\\n                        format!(\\\"{}=\\\\\\\"{}\\\\\\\"\\\", k, v)\\n                    })\\n                    .collect::<Vec<_>>()\\n                    .join(\\\" \\\");\\n                let children = self\\n                    .children\\n                    .iter()\\n                    .clone()\\n                    .into_iter()\\n                    .map(|node| node.to_string())\\n                    .collect::<Vec<_>>()\\n                    .join(\\\"\\\");\\n                if attrs != \\\"\\\" {\\n                    format!(\\\"<{} {}>{}</{}>\\\", e.tag_name, attrs, children, e.tag_name)\\n                } else {\\n                    format!(\\\"<{}>{}</{}>\\\", e.tag_name, children, e.tag_name)\\n                }\\n            }\\n            NodeType::Text(ref t) => t.data.clone(),\\n        }\\n    }\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"v8-バインディングの用意\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#v8-%E3%83%90%E3%82%A4%E3%83%B3%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AE%E7%94%A8%E6%84%8F\",\n    \"aria-label\": \"v8 バインディングの用意 permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"V8 \\u30D0\\u30A4\\u30F3\\u30C7\\u30A3\\u30F3\\u30B0\\u306E\\u7528\\u610F\"), mdx(\"p\", null, \"\\u3053\\u3053\\u304B\\u3089\\u306F\\u5C11\\u3057\\u3084\\u3084\\u3053\\u3057\\u3044\\u3067\\u3059\\u304C\\u3001V8 \\u5185\\u3067\\u5B9F\\u884C\\u3055\\u308C\\u308B JavaScript \\u3068 Rust \\u30B3\\u30FC\\u30C9\\u3092\\u4E0A\\u624B\\u304F\\u7D10\\u4ED8\\u3051\\u308B\\u305F\\u3081\\u306E\\u30D0\\u30A4\\u30F3\\u30C7\\u30A3\\u30F3\\u30B0\\u3092\\u5B9F\\u88C5\\u3057\\u3066\\u3044\\u304D\\u307E\\u3059\\u3002\"), mdx(\"p\", null, \"\\u307E\\u305A\\u306F \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/javascript/binding.rs\"), \" \\u30D5\\u30A1\\u30A4\\u30EB\\u3092\\u4F5C\\u6210\\u3057\\u3001\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306B \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"to_v8_node()\"), \" \\u95A2\\u6570\\u3068 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"to_linked_rust_node()\"), \" \\u95A2\\u6570\\u3092\\u5B9A\\u7FA9\\u3057\\u307E\\u3057\\u3087\\u3046:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"use crate::{\\n    dom::{Node, NodeType},\\n    javascript::JavaScriptRuntime,\\n};\\n\\nuse std::ffi::c_void;\\n\\nuse rusty_v8 as v8;\\nuse v8::READ_ONLY;\\n\\ntype NodeRefTarget<'a> = &'a mut Box<Node>;\\n\\n/// `to_v8_node` returns the v8 representation of the given `Node` object.\\nfn to_v8_node<'s>(\\n    scope: &mut v8::HandleScope<'s>,\\n    node_rust: NodeRefTarget,\\n) -> v8::Local<'s, v8::Object> {\\n    // create new node instance\\n    let template = v8::ObjectTemplate::new(scope);\\n    template.set_internal_field_count(1);\\n    let node_v8 = template.new_instance(scope).unwrap();\\n\\n    // set a reference to Node into the internal field\\n    let boxed_ref = Box::new(node_rust);\\n    let addr = Box::leak(boxed_ref) as *mut NodeRefTarget as *mut c_void;\\n    let v8_ext = v8::External::new(scope, addr);\\n    let target_node_ref_v8: v8::Local<v8::Value> = v8_ext.into();\\n    node_v8.set_internal_field(0, target_node_ref_v8);\\n\\n    // all set :-)\\n    node_v8\\n}\\n\\n/// `to_linked_rust_node` returns a `Node` object that corresponds with the given `node_v8`.\\nfn to_linked_rust_node<'s>(\\n    scope: &mut v8::HandleScope<'s>,\\n    node_v8: v8::Local<v8::Object>,\\n) -> &'s mut NodeRefTarget<'s> {\\n    let node_v8 = node_v8.get_internal_field(scope, 0).unwrap();\\n    let node = unsafe { v8::Local::<v8::External>::cast(node_v8) };\\n    let node = node.value() as *mut NodeRefTarget;\\n    unsafe { &mut *node }\\n}\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"to_v8_node()\"), \" \\u95A2\\u6570\\u306F\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"&'a mut Box<Node>\"), \" \\u578B\\u3067\\u4E0E\\u3048\\u3089\\u308C\\u305F Rust \\u4E0A\\u3067\\u306E DOM \\u30C4\\u30EA\\u30FC\\u306E\\u30CE\\u30FC\\u30C9\\u306E\\u8868\\u73FE\\u3092\\u3001JavaScript \\u304B\\u3089\\u30A2\\u30AF\\u30BB\\u30B9\\u3067\\u304D\\u308B\\u3088\\u3046\\u306A V8 \\u30AA\\u30D6\\u30B8\\u30A7\\u30AF\\u30C8\\u306B\\u5909\\u63DB\\u3059\\u308B\\u95A2\\u6570\\u3067\\u3059\\u3002\\n\\u3053\\u3053\\u3067\\u306F Rust \\u4E0A\\u3067\\u7BA1\\u7406\\u3057\\u3066\\u3044\\u308B \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Box<Node>\"), \" \\u578B\\u306E\\u30AA\\u30D6\\u30B8\\u30A7\\u30AF\\u30C8\\u306E\\u30E1\\u30E2\\u30EA\\u4E0A\\u3067\\u306E\\u30A2\\u30C9\\u30EC\\u30B9\\u3092\\u3088\\u3057\\u306A\\u306B\\u5F97\\u3066\\u3001\\u5404 V8 \\u30AA\\u30D6\\u30B8\\u30A7\\u30AF\\u30C8\\u304C\\u500B\\u5225\\u306B\\u6301\\u3064\\u5185\\u90E8\\u30D5\\u30A3\\u30FC\\u30EB\\u30C9\\uFF08internal field\\uFF09\\u306B\\u305D\\u306E\\u30A2\\u30C9\\u30EC\\u30B9\\u3092\\u4FDD\\u6301\\u3055\\u305B\\u3066\\u3044\\u307E\\u3059\\u3002\"), mdx(\"p\", null, \"\\u4E00\\u65B9 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"to_linked_rust_node()\"), \" \\u95A2\\u6570\\u306F\\u3001\\u4E0E\\u3048\\u3089\\u308C\\u305F V8 \\u30AA\\u30D6\\u30B8\\u30A7\\u30AF\\u30C8\\u306B\\u7D10\\u3065\\u304F Rust \\u4E0A\\u3067\\u306E DOM \\u30C4\\u30EA\\u30FC\\u306E\\u30CE\\u30FC\\u30C9\\u306E\\u8868\\u73FE\\u3092\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"to_v8_node()\"), \" \\u95A2\\u6570\\u306B\\u304A\\u3044\\u3066 V8 \\u30AA\\u30D6\\u30B8\\u30A7\\u30AF\\u30C8\\u306E\\u5185\\u90E8\\u30D5\\u30A3\\u30FC\\u30EB\\u30C9\\u306B\\u683C\\u7D0D\\u3055\\u308C\\u305F\\u30E1\\u30E2\\u30EA\\u30A2\\u30C9\\u30EC\\u30B9\\u3092\\u53C2\\u7167\\u3059\\u308B\\u3053\\u3068\\u3067\\u53D6\\u5F97\\u3059\\u308B\\u95A2\\u6570\\u3067\\u3059\\u3002\"), mdx(\"p\", null, \"\\u3053\\u308C\\u3089\\u306E 2 \\u3064\\u306E\\u95A2\\u6570\\u306B\\u3088\\u308A\\u3001Rust \\u4E0A\\u3067\\u306E DOM \\u30C4\\u30EA\\u30FC\\u306E\\u30CE\\u30FC\\u30C9\\u306E\\u8868\\u73FE\\u304B\\u3089\\u3001JavaScript \\u304B\\u3089\\u30A2\\u30AF\\u30BB\\u30B9\\u3067\\u304D\\u308B DOM \\u30C4\\u30EA\\u30FC\\u306E\\u30CE\\u30FC\\u30C9\\u306E\\u8868\\u73FE\\u3092\\u5F97\\u305F\\u308A\\u3001\\u307E\\u305F\\u306F\\u305D\\u306E\\u9006\\u3092\\u3057\\u305F\\u308A\\u3001\\u3068\\u3044\\u3046\\u3053\\u3068\\u304C\\u53EF\\u80FD\\u306B\\u306A\\u308A\\u307E\\u3059\\u3002\"), mdx(\"p\", null, \"\\u4ECA\\u5EA6\\u306F\\u3053\\u308C\\u3092\\u7528\\u3044\\u3066\\u3001\\u300CRust \\u4E0A\\u306E DOM \\u30C4\\u30EA\\u30FC\\u306E\\u30CE\\u30FC\\u30C9 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Node\"), \" \\u306E\\u3046\\u3061 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"node_type\"), \" \\u304C \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"NodeType::Element(...)\"), \" \\u3067\\u3042\\u308B\\u3088\\u3046\\u306A\\u3082\\u306E\\u300D\\u3092\\u300CJavaScript \\u4E0A\\u304B\\u3089\\u89E6\\u308C\\u308B \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Element\"), \" \\u30A4\\u30F3\\u30BF\\u30FC\\u30D5\\u30A7\\u30A4\\u30B9\\u3092\\u6301\\u3063\\u305F\\u30AA\\u30D6\\u30B8\\u30A7\\u30AF\\u30C8\\u300D\\u306B\\u5909\\u63DB\\u3059\\u308B\\u95A2\\u6570 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"to_v8_element()\"), \" \\u3092\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306B\\u5B9F\\u88C5\\u3057\\u307E\\u3057\\u3087\\u3046:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"fn to_v8_element<'s>(\\n    scope: &mut v8::HandleScope<'s>,\\n    tag_name: &str,\\n    _attributes: Vec<(String, String)>,\\n    node_rust: NodeRefTarget,\\n) -> v8::Local<'s, v8::Object> {\\n    let node = to_v8_node(scope, node_rust);\\n\\n    // create properties of the node\\n    {\\n        // create `tagName` property\\n        let key = v8::String::new(scope, \\\"tagName\\\").unwrap();\\n        let value = v8::String::new(scope, tag_name).unwrap();\\n        node.define_own_property(scope, key.into(), value.into(), READ_ONLY);\\n    }\\n\\n    {\\n        // create `innerHTML` property\\n        let key = v8::String::new(scope, \\\"innerHTML\\\").unwrap();\\n        node.set_accessor_with_setter(\\n            scope,\\n            key.into(),\\n            // innerHTML \\u30D7\\u30ED\\u30D1\\u30C6\\u30A3\\u304C\\u8AAD\\u307F\\u51FA\\u3055\\u308C\\u305F\\u969B\\u306E\\u51E6\\u7406\\n            move |scope: &mut v8::HandleScope,\\n                  _key: v8::Local<v8::Name>,\\n                  args: v8::PropertyCallbackArguments,\\n                  mut rv: v8::ReturnValue| {\\n                // `innerHTML` \\u30D7\\u30ED\\u30D1\\u30C6\\u30A3\\u3092\\u6301\\u3064\\u30AA\\u30D6\\u30B8\\u30A7\\u30AF\\u30C8\\u3092\\u7279\\u5B9A\\u3059\\u308B\\n                let this = args.this();\\n\\n                // Rust \\u4E0A\\u306E DOM \\u30C4\\u30EA\\u30FC\\u306E\\u30CE\\u30FC\\u30C9\\u3092\\u7279\\u5B9A\\u3059\\u308B\\n                let node = to_linked_rust_node(scope, this);\\n\\n                // Rust \\u4E0A\\u306E DOM \\u30C4\\u30EA\\u30FC\\u306E\\u30CE\\u30FC\\u30C9\\u3092\\u30C6\\u30AD\\u30B9\\u30C8\\u8868\\u73FE\\u306B\\u5909\\u63DB\\u3057\\u3001innerHTML \\u30D7\\u30ED\\u30D1\\u30C6\\u30A3\\u306E\\u5024\\u3068\\u3057\\u3066\\u8FD4\\u3059\\n                let ret = v8::String::new(scope, node.inner_html().as_str()).unwrap();\\n                rv.set(ret.into());\\n            },\\n            // innerHTML \\u30D7\\u30ED\\u30D1\\u30C6\\u30A3\\u3078\\u306E\\u4EE3\\u5165\\u304C\\u3042\\u3063\\u305F\\u969B\\u306E\\u51E6\\u7406\\n            move |scope: &mut v8::HandleScope,\\n                  _key: v8::Local<v8::Name>,\\n                  value: v8::Local<v8::Value>,\\n                  args: v8::PropertyCallbackArguments| {\\n                // `innerHTML` \\u30D7\\u30ED\\u30D1\\u30C6\\u30A3\\u3092\\u6301\\u3064\\u30AA\\u30D6\\u30B8\\u30A7\\u30AF\\u30C8\\u3092\\u7279\\u5B9A\\u3059\\u308B\\n                let this = args.this();\\n\\n                // Rust \\u4E0A\\u306E DOM \\u30C4\\u30EA\\u30FC\\u306E\\u30CE\\u30FC\\u30C9\\u3092\\u7279\\u5B9A\\u3059\\u308B\\n                let node = to_linked_rust_node(scope, this);\\n\\n                // Rust \\u4E0A\\u306E DOM \\u30C4\\u30EA\\u30FC\\u8868\\u73FE\\u3092\\u66F4\\u65B0\\u3059\\u308B\\n                node.set_inner_html(value.to_rust_string_lossy(scope).as_str());\\n\\n                // \\u753B\\u9762\\u306B\\u63CF\\u753B\\u3055\\u308C\\u3066\\u3044\\u308B Cursive \\u30D3\\u30E5\\u30FC\\u3068\\u3001\\u6700\\u65B0\\u306E DOM \\u30C4\\u30EA\\u30FC\\u304C\\u4E56\\u96E2\\u3057\\u3046\\u308B\\u306E\\u3067\\u3001\\n                // \\u753B\\u9762\\u306B\\u63CF\\u753B\\u3055\\u308C\\u3066\\u3044\\u308B Cursive \\u30D3\\u30E5\\u30FC\\u306E\\u518D\\u63CF\\u753B\\u3092\\u8981\\u6C42\\u3059\\u308B\\n                JavaScriptRuntime::renderer_api(scope).rerender();\\n            },\\n        );\\n    }\\n\\n    node\\n}\\n\")), mdx(\"p\", null, \"\\u305D\\u3057\\u3066\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getElementById()\"), \" \\u95A2\\u6570\\u3092\\u6301\\u3063\\u305F V8 \\u30AA\\u30D6\\u30B8\\u30A7\\u30AF\\u30C8\\u3092\\u4F5C\\u6210\\u3057\\u3066\\u8FD4\\u3059 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"create_document_object()\"), \" \\u95A2\\u6570\\u3092\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306B\\u5B9F\\u88C5\\u3057\\u307E\\u3057\\u3087\\u3046:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"pub fn create_document_object<'s>(\\n    scope: &mut v8::ContextScope<'s, v8::EscapableHandleScope>,\\n) -> v8::Local<'s, v8::Object> {\\n    let document = v8::ObjectTemplate::new(scope).new_instance(scope).unwrap();\\n\\n    {\\n        // `getElementById()` \\u95A2\\u6570\\u306E\\u5B9A\\u7FA9\\n        let key = v8::String::new(scope, \\\"getElementById\\\").unwrap();\\n        let tmpl = v8::FunctionTemplate::new(\\n            scope,\\n            |scope: &mut v8::HandleScope,\\n             args: v8::FunctionCallbackArguments,\\n             mut retval: v8::ReturnValue| {\\n                // `getElementById()` \\u95A2\\u6570\\u306E\\u5F15\\u6570\\u3092\\u53D6\\u308A\\u51FA\\u3059\\n                let id = args\\n                    .get(0)\\n                    .to_string(scope)\\n                    .unwrap()\\n                    .to_rust_string_lossy(scope);\\n\\n                // \\u73FE\\u5728\\u63CF\\u753B\\u3055\\u308C\\u3066\\u3044\\u308B DOM \\u30C4\\u30EA\\u30FC\\u306E Rust \\u4E0A\\u3067\\u306E\\u8868\\u73FE\\u3092\\u7279\\u5B9A\\u3059\\u308B\\n                let document_element = JavaScriptRuntime::document_element(scope);\\n                let document_element = &mut document_element.borrow_mut();\\n\\n                // `getElementById()` \\u306E\\u5F15\\u6570\\u3092\\u7528\\u3044\\u3066 DOM \\u30C4\\u30EA\\u30FC\\u3092\\u691C\\u7D22\\u3057\\u3001\\u8FD4\\u308A\\u5024\\u3092\\u8A2D\\u5B9A\\u3059\\u308B\\n                retval.set(\\n                    document_element\\n                        .get_element_by_id(id.as_str())\\n                        .and_then(|n| {\\n                            if let NodeType::Element(ref mut e) = n.node_type {\\n                                let tag_name = e.tag_name.clone();\\n                                let attributes = e.attributes();\\n                                Some((n, tag_name, attributes))\\n                            } else {\\n                                None\\n                            }\\n                        })\\n                        .and_then(|(n, tag_name, attributes)| {\\n                            Some(to_v8_element(scope, tag_name.as_str(), attributes, n).into())\\n                        })\\n                        .unwrap_or_else(|| v8::undefined(scope).into()),\\n                );\\n            },\\n        );\\n        let val = tmpl.get_function(scope).unwrap();\\n        document.set(scope, key.into(), val.into());\\n    }\\n\\n    document\\n}\\n\\n\")), mdx(\"p\", null, \"\\u3053\\u308C\\u3089\\u306E\\u5B9F\\u88C5\\u304C\\u6E08\\u3093\\u3060\\u3089\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/javascript.rs\"), \" \\u306E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JavaScriptRuntime::new()\"), \" \\u306E\\u5B9A\\u7FA9\\u5185\\u306E context \\u306E\\u4F5C\\u6210\\u3092\\u884C\\u3063\\u3066\\u3044\\u308B\\u7B87\\u6240\\u3092\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306B\\u4FEE\\u6B63\\u3057\\u3001\\u5B9F\\u969B\\u306B\\u30B0\\u30ED\\u30FC\\u30D0\\u30EB\\u5909\\u6570\\u306E\\u4E2D\\u306B \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"document\"), \" \\u5909\\u6570\\u3092\\u4F5C\\u6210\\u3057\\u307E\\u3057\\u3087\\u3046:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"impl JavaScriptRuntime {\\n    /* ... */\\n\\n    pub fn new(document_element: Rc<RefCell<Box<Node>>>, renderer_api: Rc<RendererAPI>) -> Self {\\n        /* ... */\\n\\n        let context = {\\n            let isolate_scope = &mut v8::HandleScope::new(&mut isolate);\\n            let handle_scope = &mut v8::EscapableHandleScope::new(isolate_scope);\\n\\n            let context = v8::Context::new(handle_scope);\\n\\n            let global = context.global(handle_scope);\\n            {\\n                // `create_document_object()` \\u306E\\u8FD4\\u308A\\u5024\\u3092\\u30B0\\u30ED\\u30FC\\u30D0\\u30EB\\u5909\\u6570 `document` \\u306B\\u683C\\u7D0D\\u3059\\u308B\\n                let scope = &mut v8::ContextScope::new(handle_scope, context);\\n                let key = v8::String::new(scope, \\\"document\\\").unwrap();\\n                let document = create_document_object(scope);\\n                global.set(scope, key.into(), document.into());\\n            }\\n\\n            let context_scope = handle_scope.escape(context);\\n            v8::Global::new(handle_scope, context_scope)\\n        };\\n\\n\\n        /* ... */\\n    }\\n\\n    /* ... */\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"実装のテスト\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#%E5%AE%9F%E8%A3%85%E3%81%AE%E3%83%86%E3%82%B9%E3%83%88\",\n    \"aria-label\": \"実装のテスト permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"\\u5B9F\\u88C5\\u306E\\u30C6\\u30B9\\u30C8\"), mdx(\"p\", null, \"\\u6700\\u5F8C\\u306B \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main.rs\"), \" \\u5185\\u306E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"HTML\"), \" \\u3068\\u3044\\u3046\\u5909\\u6570\\u3092\\u4EE5\\u4E0B\\u306E\\u3088\\u3046\\u306B\\u66F8\\u304D\\u63DB\\u3048\\u3001\\u5B9F\\u969B\\u306B Web \\u30DA\\u30FC\\u30B8\\u5185\\u306E JavaScript \\u3092\\u5B9F\\u884C\\u3055\\u305B\\u3066\\u307F\\u307E\\u3057\\u3087\\u3046:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-rust\"\n  }, \"const HTML: &str = r#\\\"<body>\\n    <p>hello</p>\\n    <p class=\\\"inline\\\">world</p>\\n    <p class=\\\"inline\\\">:)</p>\\n    <div class=\\\"none\\\"><p>this should not be shown</p></div>\\n    <style>\\n        .none {\\n            display: none;\\n        }\\n        .inline {\\n            display: inline;\\n        }\\n    </style>\\n\\n    <div id=\\\"result\\\">\\n        <p>not loaded</p>\\n    </div>\\n    <script>\\n        document.getElementById(\\\"result\\\").innerHTML = `\\\\x3cp\\\\x3eloaded\\\\x3c/p\\\\x3e`\\n    </script>\\n</body>\\\"#;\\n\")), mdx(\"p\", null, \"\\u3046\\u307E\\u304F\\u5B9F\\u884C\\u3067\\u304D\\u308B\\u3068\\u3001\\u63CF\\u753B\\u3055\\u308C\\u305F Web \\u30DA\\u30FC\\u30B8\\u5185\\u306B\\u306F \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"not loaded\"), \" \\u3068\\u3044\\u3046\\u6587\\u5B57\\u5217\\u3067\\u306F\\u306A\\u304F\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"loaded\"), \" \\u3068\\u3044\\u3046\\u6587\\u5B57\\u5217\\u304C\\u8868\\u793A\\u3055\\u308C\\u308B\\u306F\\u305A\\u3067\\u3059\\u3002\\u4EE5\\u4E0B\\u306B\\u753B\\u9762\\u4F8B\\u3092\\u793A\\u3057\\u307E\\u3059:\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"440px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"67.27272727272727%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLUlEQVQ4y6WTwUoCYRSFezPdqduC6l1aGmhBVLtCI3yEaho1JHWc0XFmfnXUdPLXUVEToXf4gqG2Qf2Ly919nHPuuXuOW2U99Zj3G2zmHoWyQyztkcoKklmPZLR/n0TGI3XeI35SZq/eKDEJHBZhj89Nj7zWJJYWpCLYP4A1o8jorYV8d1mHDjmtSVwF6LivfCx9QinYrToUSt+WzxQsz8Y2w0GThbTJPSkqrNZ1+n0TIepMRia3jxbxUwWg1XphuxogpWC7FNzpLbWjmM0Scmwj/UZk+V631YCGVWQxFcxGNuu5G9VGLUNDw/ctgsBlt+py82CqZWiYz4TSZRK0Wc/a5DVLTWHNqiCnfYbjDuGsS153iau83kG2wtG14PDS4fjKZf/CI5H5gf0d+AWvt9HuqaP5OQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n          \", mdx(\"source\", {\n    parentName: \"picture\",\n    \"srcSet\": [\"/static/8d634d926d26a43538cf2d186d66f980/06595/result.webp 110w\", \"/static/8d634d926d26a43538cf2d186d66f980/b5458/result.webp 220w\", \"/static/8d634d926d26a43538cf2d186d66f980/23a50/result.webp 440w\", \"/static/8d634d926d26a43538cf2d186d66f980/cc661/result.webp 660w\", \"/static/8d634d926d26a43538cf2d186d66f980/a149a/result.webp 755w\"],\n    \"sizes\": \"(max-width: 440px) 100vw, 440px\",\n    \"type\": \"image/webp\"\n  }), \"\\n          \", mdx(\"source\", {\n    parentName: \"picture\",\n    \"srcSet\": [\"/static/8d634d926d26a43538cf2d186d66f980/23543/result.png 110w\", \"/static/8d634d926d26a43538cf2d186d66f980/c8042/result.png 220w\", \"/static/8d634d926d26a43538cf2d186d66f980/48c0e/result.png 440w\", \"/static/8d634d926d26a43538cf2d186d66f980/1f083/result.png 660w\", \"/static/8d634d926d26a43538cf2d186d66f980/cab43/result.png 755w\"],\n    \"sizes\": \"(max-width: 440px) 100vw, 440px\",\n    \"type\": \"image/png\"\n  }), \"\\n          \", mdx(\"img\", {\n    parentName: \"picture\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/8d634d926d26a43538cf2d186d66f980/48c0e/result.png\",\n    \"alt\": \"JavaScript が実行されたときの Web ページの描画例\",\n    \"title\": \"JavaScript が実行されたときの Web ページの描画例\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  }), \"\\n        \"), \"\\n    \")), mdx(\"p\", null, \"\\u3053\\u308C\\u3067\\u30DF\\u30CB DOM API \\u304C\\u5B9F\\u88C5\\u3067\\u304D\\u307E\\u3057\\u305F\\uFF01\"), mdx(\"div\", {\n    \"className\": \"footnotes\"\n  }, mdx(\"hr\", {\n    parentName: \"div\"\n  }), mdx(\"ol\", {\n    parentName: \"div\"\n  }, mdx(\"li\", {\n    parentName: \"ol\",\n    \"id\": \"fn-1\"\n  }, \"\\u5B8C\\u5168\\u306B\\u4F59\\u8AC7\\u3067\\u3059\\u304C\\u3001\\u3053\\u306E\\u5468\\u8FBA\\u306E\\u5B9F\\u88C5\\u304C\\u63CF\\u753B\\u3078\\u306E\\u95A2\\u5FC3\\u3068\\u72B6\\u614B\\u7BA1\\u7406\\u3078\\u306E\\u95A2\\u5FC3\\u304C\\u6DF7\\u5728\\u3057\\u305F\\u3088\\u3046\\u306A\\u7F8E\\u3057\\u304F\\u306A\\u3044\\u5B9F\\u88C5\\u306B\\u306A\\u3063\\u3066\\u3057\\u307E\\u3063\\u3066\\u3044\\u308B\\u306E\\u306F\\u3001\\u30A4\\u30D9\\u30F3\\u30C8\\u30EB\\u30FC\\u30D7\\u306E\\u53D6\\u308A\\u6271\\u3044\\u3092\\u5B8C\\u5168\\u306B Cursive \\u306B\\u4EFB\\u305B\\u3066\\u3044\\u308B\\u304B\\u3089\\u3060\\u3068\\u601D\\u3063\\u3066\\u3044\\u307E\\u3059\\u3002\\u30A4\\u30D9\\u30F3\\u30C8\\u30EB\\u30FC\\u30D7\\u306B\\u95A2\\u3059\\u308B\\u304D\\u308C\\u3044\\u306A\\u62BD\\u8C61\\u5316\\u30EC\\u30A4\\u30E4\\u3092\\u5225\\u9014\\u5165\\u308C\\u308C\\u3070\\u3053\\u306E\\u3088\\u3046\\u306A\\u95A2\\u5FC3\\u306E\\u6DF7\\u5728\\u306F\\u907F\\u3051\\u3089\\u308C\\u308B\\u306F\\u305A\\u306A\\u306E\\u3067\\u3001\\u672C\\u30AA\\u30F3\\u30E9\\u30A4\\u30F3\\u30D6\\u30C3\\u30AF\\u306B\\u306F\\u6298\\u3092\\u898B\\u3066\\u5168\\u4F53\\u7684\\u306A\\u4FEE\\u6B63\\u3092\\u52A0\\u3048\\u305F\\u3044\\u3068\\u8003\\u3048\\u3066\\u3044\\u307E\\u3059\\u3002\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#fnref-1\",\n    \"className\": \"footnote-backref\"\n  }, \"\\u21A9\")), mdx(\"li\", {\n    parentName: \"ol\",\n    \"id\": \"fn-2\"\n  }, \"\\u672C\\u6765\\u306F \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"getElementById\"), \" \\u306E\\u5B9F\\u88C5\\u306F \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Document\"), \" \\u30A4\\u30F3\\u30BF\\u30FC\\u30D5\\u30A7\\u30A4\\u30B9\\u3084 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"DocumentFragment\"), \" \\u30A4\\u30F3\\u30BF\\u30FC\\u30D5\\u30A7\\u30A4\\u30B9\\u306A\\u3069\\u306E \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"NonElementParentNode\"), \" \\u30A4\\u30F3\\u30BF\\u30FC\\u30D5\\u30A7\\u30A4\\u30B9\\u3092\\u542B\\u3080\\u3082\\u306E\\u306B\\u7D10\\u4ED8\\u3044\\u3066\\u304A\\u308A\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Node\"), \" \\u30A4\\u30F3\\u30BF\\u30FC\\u30D5\\u30A7\\u30A4\\u30B9\\u306B\\u306F\\u542B\\u307E\\u308C\\u3066\\u3044\\u307E\\u305B\\u3093\\u304C\\u3001\\u4ECA\\u56DE\\u306F\\u7C21\\u5358\\u306E\\u305F\\u3081 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Node\"), \" \\u69CB\\u9020\\u4F53\\u306B\\u6301\\u305F\\u305B\\u3066\\u3044\\u307E\\u3059\\u3002\\n\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"innerHTML\"), \" \\u306E\\u5B9F\\u88C5\\u3082\\u672C\\u6765\\u306F \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Element\"), \" \\u30A4\\u30F3\\u30BF\\u30FC\\u30D5\\u30A7\\u30A4\\u30B9\\u7B49\\u306B\\u7D10\\u3065\\u304F\\u3082\\u306E\\u3067\\u3042\\u308A\\u3001\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Node\"), \" \\u30A4\\u30F3\\u30BF\\u30FC\\u30D5\\u30A7\\u30A4\\u30B9\\u306B\\u306F\\u542B\\u307E\\u308C\\u3066\\u3044\\u307E\\u305B\\u3093\\u304C\\u3001\\u540C\\u69D8\\u306B\\u7C21\\u5358\\u306E\\u305F\\u3081 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Node\"), \" \\u69CB\\u9020\\u4F53\\u306E\\u5B9F\\u88C5\\u3068\\u3057\\u3066\\u3044\\u307E\\u3059\\u3002\\n\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Node\"), \" \\u69CB\\u9020\\u4F53\\u306E\\u521D\\u671F\\u306E\\u5B9A\\u7FA9\\u304C\\u3042\\u307E\\u308A\\u826F\\u304F\\u306A\\u304B\\u3063\\u305F\\u306E\\u3067\\u3053\\u3046\\u305B\\u3056\\u308B\\u3092\\u5F97\\u306A\\u3044\\u3001\\u3068\\u3044\\u3046\\u3068\\u3053\\u308D\\u3082\\u3042\\u308B\\u306E\\u3067\\u3001\\u6B63\\u76F4 Servo \\u306E DOM \\u30C4\\u30EA\\u30FC\\u306E\\u6301\\u3061\\u65B9\\u3092\\u53C2\\u8003\\u306B\\u3057\\u306A\\u304C\\u3089\\u5168\\u4F53\\u7684\\u306B\\u30EA\\u30E9\\u30A4\\u30C8\\u3057\\u305F\\u3044\\u3067\\u3059\\u2026\\u2026\\u3002\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#fnref-2\",\n    \"className\": \"footnote-backref\"\n  }, \"\\u21A9\")))));\n}\n;\nMDXContent.isMDXComponent = true;","headings":[{"depth":2,"value":"本章での実装方針"},{"depth":2,"value":"実装"},{"depth":3,"value":"Web ブラウザの状態保持の実装"},{"depth":3,"value":"DOM 操作関連の Rust 実装の用意"},{"depth":3,"value":"V8 バインディングの用意"},{"depth":3,"value":"実装のテスト"}]}},"pageContext":{"slug":"/chapters/building-dom-api/","prev":{"label":"JavaScript エンジンを組み込む","link":"/chapters/integrating-v8"},"next":{"label":"[WIP] ブラウザとセキュリティ","link":"/chapters/browser-security"},"repositoryEditUrl":"https://github.com/lmt-swallow/browserbook/tree/main/src/docs/chapters/building-dom-api/index.mdx","repositoryProvider":"GitHub"}},"staticQueryHashes":["1954253342","2328931024","2501019404","973074209"]}